# 03. Структура Документа и Редактор (Core)

## 1. Модель данных
*   **Document Structure:** Дерево `OutputSections` (соответствует шаблону CSR, например ICH E3).
*   **Content:** Хранится в HTML/JSON (совместимо с Tiptap).
*   **Linkage:** Каждая секция может иметь ссылку на `source_rules` (правило, откуда брать данные).

## 2. Редактор (Tiptap) + AI Actions
*   **AI Panel:**
    *   Кнопка "Generate Draft" для раздела.
    *   Вызывает Python API `POST /generate_section`.
    *   Отображает статус генерации ("Reading Protocol...", "Analyzing Tables...", "Writing...").
*   **Review Mode:**
    *   Пользователь видит сгенерированный текст.
    *   Слева/Справа подсвечивается *источник* (исходная Markdown-таблица или текст из Протокола), использованный для генерации.

## 3. Работа с Таблицами
*   Сгенерированные таблицы вставляются в редактор как нативные Tiptap-таблицы.
*   Пользователь может редактировать их вручную.